# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
**Load the data (i.e. read.csv())**

```{r, echo=TRUE}
rm(list=ls())   #Clear all objects

#Load libraries
require(dplyr)

#Set directory and file vectors
working.dir <- "C://Education//Reproducible Research//Homework//Peer Assessment 1"
input.dir <- ".\\input\\"
output.dir <- ".\\output\\"
script.dir <- ".\\scripts\\"
input.file.name <- "activity.csv"

#Set working directory
setwd(working.dir)

#Load the data
activity.data <- read.csv(paste(input.dir, input.file.name, sep="\\"), stringsAsFactors = FALSE)
```
**Process/transform the data (if necessary) into a format suitable for your analysis**
```{r, echo=TRUE}
steps.per.day <- activity.data %.%
  filter(steps >= 0) %.%  
  select(date, steps) %.%
  group_by(date) %.%
  summarize(sum.steps = round(sum(steps), 1)) %.%
  arrange(date)
```


## What is mean total number of steps taken per day?
**Make a histogram of the total number of steps taken each day**

```{r fig.width=7, fig.height=6, echo=TRUE}
hist(c(steps.per.day$sum.steps), main = "Histogram of the Total Number of Steps Takens Each Day", xlab = "Steps Per Day")
```
**Calculate and report the mean total number of steps taken per day**
```{r, echo=TRUE}
round(mean(steps.per.day$sum.steps), 2)
```
**Calculate and report the median total number of steps taken per day**
```{r, echo=TRUE}
median(steps.per.day$sum.steps)
```


## What is the average daily activity pattern?
**Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)**
```{r, echo=TRUE}
average.daily.pattern <- activity.data %.%
  filter(steps >= 0) %.%  
  select(interval, steps) %.%
  group_by(interval) %.%
  summarize(mean.steps = round(mean(steps), 1)) %.%
  arrange(interval)

plot(average.daily.pattern, type="l", main = "Average Daily Activity Pattern", xlab = "5-minute interval", ylab = "Avg # of steps taken across all days", col = "blue")
```

## Imputing missing values
**Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)**
```{r, echo=TRUE}
nrow(activity.data[is.na(activity.data$steps), ])
```
**Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.**  

I will impute the missing values by using the mean for that 5-minute interval.

**Create a new dataset that is equal to the original dataset but with the missing data filled in.**  
```{r, echo=TRUE}
activity.data.non.na <- filter(activity.data, is.na(steps) == FALSE)
activity.data.na <- filter(activity.data, is.na(steps) == TRUE)
temp <- inner_join(average.daily.pattern, activity.data.na, by = c("interval"))
activity.data.new <- rbind(activity.data.non.na, select(temp, steps = mean.steps, date, interval))
```
**Make a histogram of the total number of steps taken each day v2**  
```{r, echo=TRUE}
steps.per.day.v2 <- activity.data.new %.%
  #filter(steps >= 0) %.%  
  select(date, steps) %.%
  group_by(date) %.%
  summarize(sum.steps = round(sum(steps), 1)) %.%
  arrange(date)
```
```{r fig.width=7, fig.height=6, echo=TRUE}
hist(c(steps.per.day.v2$sum.steps), main = "Histogram of the Total Number of Steps Takens Each Day v2", xlab = "Steps Per Day")
```
**Calculate and report the mean total number of steps taken per day v2**
```{r, echo=TRUE}
round(mean(steps.per.day.v2$sum.steps), 2)
```
**Calculate and report the median total number of steps taken per day v2**
```{r, echo=TRUE}
median(steps.per.day.v2$sum.steps)
```
## Are there differences in activity patterns between weekdays and weekends?
